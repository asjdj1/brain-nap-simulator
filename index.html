<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大脑健康白天小睡模拟器 - 基于最新研究</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2c3e50, #1a2a6c);
            color: white;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 20px;
            position: relative;
            background: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(0, 255, 255, 0.7);
            background: linear-gradient(to right, #00ffff, #ffffff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            position: relative;
            animation: glow 2s infinite alternate;
        }
        
        .subtitle {
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto 15px;
            color: #a0d2eb;
            line-height: 1.6;
            padding: 0 20px;
        }
        
        .record-reminder {
            background: rgba(0, 60, 120, 0.6);
            border-radius: 10px;
            padding: 15px;
            margin: 0 auto 20px;
            max-width: 800px;
            border: 1px solid rgba(0, 200, 255, 0.3);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .record-reminder h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #00ffff;
            margin-bottom: 10px;
        }
        
        .record-reminder p {
            margin: 8px 0;
            color: #c0e6ff;
            font-size: 0.95rem;
        }
        
        .research-highlights {
            background: rgba(0, 40, 80, 0.6);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #3498db;
        }
        
        .research-highlights h2 {
            color: #00ffff;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .highlight-item {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 60, 120, 0.4);
            border-radius: 10px;
        }
        
        .highlight-icon {
            font-size: 1.5rem;
            margin-right: 15px;
            color: #3498db;
        }
        
        .identity-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .identity-card {
            width: 180px;
            background: rgba(0, 40, 80, 0.7);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .identity-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .identity-card.selected {
            border: 2px solid #00ffff;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
            background: rgba(0, 80, 160, 0.8);
        }
        
        .identity-card i {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .identity-card.student i {
            color: #4cd97b;
        }
        
        .identity-card.adult i {
            color: #5fa3ff;
        }
        
        .identity-card.elderly i {
            color: #ff6b6b;
        }
        
        .identity-card h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
        }
        
        .identity-card p {
            font-size: 0.9rem;
            color: #89c2d9;
        }
        
        .game-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(0, 20, 40, 0.85);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        .panel-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(0, 255, 255, 0.3);
            color: #00ffff;
            font-size: 1.6rem;
        }
        
        .brain-status {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .metric {
            background: rgba(0, 40, 80, 0.7);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .metric:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .metric-name {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #a0d2eb;
        }
        
        .metric-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #ff6b6b;
        }
        
        .metric-description {
            font-size: 0.85rem;
            margin-top: 10px;
            color: #89c2d9;
            min-height: 60px;
        }
        
        .progress-bar {
            height: 12px;
            background: rgba(0, 50, 100, 0.6);
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease-in-out;
        }
        
        .controls {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .control-group {
            background: rgba(0, 30, 60, 0.7);
            padding: 20px;
            border-radius: 12px;
        }
        
        .option-title {
            color: #00ffff;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .slider-container {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 40, 80, 0.5);
            border-radius: 15px;
        }
        
        .slider-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .custom-slider {
            width: 100%;
            height: 40px;
            -webkit-appearance: none;
            appearance: none;
            outline: none;
            border-radius: 20px;
            padding: 0 5px;
        }
        
        .time-slider {
            background: linear-gradient(to right, #1a2a6c, #3498db, #1a2a6c);
        }
        
        .duration-slider {
            background: linear-gradient(to right, #1a6c2a, #34db58, #1a6c2a);
        }
        
        .custom-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transition: all 0.3s ease;
        }
        
        .time-slider::-webkit-slider-thumb {
            background: #00ffff;
        }
        
        .duration-slider::-webkit-slider-thumb {
            background: #4cd97b;
        }
        
        .custom-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        .slider-marks {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #89c2d9;
        }
        
        .slider-display {
            text-align: center;
            margin-top: 15px;
            font-size: 1.4rem;
            font-weight: bold;
            background: rgba(0, 60, 120, 0.6);
            padding: 10px;
            border-radius: 10px;
            border: 2px solid rgba(0, 200, 255, 0.3);
        }
        
        .slider-display span {
            color: #00ffea;
        }
        
        .zone-indicator {
            text-align: center;
            margin-top: 10px;
            font-size: 1rem;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .risk-zone {
            background: rgba(255, 107, 107, 0.3);
            color: #ff6b6b;
        }
        
        .optimal-zone {
            background: rgba(76, 217, 123, 0.3);
            color: #4cd97b;
        }
        
        .neutral-zone {
            background: rgba(160, 210, 235, 0.3);
            color: #a0d2eb;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #00c9ff, #00ffea);
            color: #001f3f;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            width: 100%;
            box-shadow: 0 5px 15px rgba(0, 201, 255, 0.4);
        }
        
        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 201, 255, 0.6);
        }
        
        .action-btn:active {
            transform: translateY(1px);
        }
        
        .action-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result-container {
            background: rgba(0, 20, 40, 0.85);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 1px solid rgba(0, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .result-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #00ffff;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }
        
        .result-content {
            font-size: 1.3rem;
            line-height: 1.6;
            max-width: 800px;
            margin-bottom: 20px;
        }
        
        .result-details {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 30px;
            width: 100%;
        }
        
        @media (max-width: 600px) {
            .result-details {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .result-change {
            background: rgba(0, 40, 80, 0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 1rem;
        }
        
        .positive {
            color: #4cd97b;
        }
        
        .negative {
            color: #ff6b6b;
        }
        
        .result-explanation {
            background: rgba(0, 30, 60, 0.7);
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            text-align: left;
            width: 100%;
        }
        
        .result-explanation h3 {
            color: #00ffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .result-explanation ul {
            padding-left: 20px;
            margin: 10px 0;
        }
        
        .result-explanation li {
            margin: 8px 0;
            line-height: 1.5;
        }
        
        .brain-animation {
            position: absolute;
            top: 0;
            right: 0;
            width: 180px;
            height: 180px;
            opacity: 0.1;
            z-index: -1;
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(100px, 50px) rotate(90deg); }
            50% { transform: translate(200px, 0) rotate(180deg); }
            75% { transform: translate(100px, -50px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff; }
            to { text-shadow: 0 0 20px #00ffff, 0 0 30px #00ffff, 0 0 40px #00ffff; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .fade-in {
            animation: fadeIn 1.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #89c2d9;
            font-size: 0.9rem;
            background: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
        }
        
        .reference {
            text-align: left;
            margin-top: 30px;
            padding: 20px;
            background: rgba(0, 30, 60, 0.6);
            border-radius: 15px;
            font-size: 0.9rem;
        }
        
        .reference h3 {
            color: #00ffff;
            margin-bottom: 15px;
        }
        
        .reference p {
            margin: 10px 0;
            line-height: 1.4;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 80, 160, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateX(150%);
            transition: transform 0.5s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification i {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-brain"></i> 大脑健康白天小睡模拟器</h1>
            <p class="subtitle">基于最新研究：选择身份并优化白天小睡习惯，改善大脑健康</p>
            
            <div class="record-reminder">
                <h3><i class="fas fa-clipboard-list"></i> 重要提示：记录近期白天小睡信息</h3>
                <p>为了获得更准确的大脑健康评估，请您记录近期3-5天的白天小睡情况：</p>
                <p><i class="fas fa-clock"></i> <strong>小睡时间</strong>：每天小睡的具体时间（例如：12:30）</p>
                <p><i class="fas fa-hourglass-half"></i> <strong>小睡时长</strong>：每次小睡的持续时间（例如：40分钟）</p>
                <p><i class="fas fa-calendar-alt"></i> <strong>规律性</strong>：小睡时间是否每天大致相同？</p>
                <p>这些信息将帮助我们更准确地评估您白天小睡习惯对大脑健康的影响！</p>
            </div>
        </header>
        
        <div class="research-highlights">
            <h2><i class="fas fa-flask"></i> 研究关键发现</h2>
            <div class="highlight-item">
                <div class="highlight-icon"><i class="fas fa-user-graduate"></i></div>
                <div>
                    <strong>上午小睡风险高</strong>：上午小睡与阿尔茨海默病风险增加15%相关
                </div>
            </div>
            <div class="highlight-item">
                <div class="highlight-icon"><i class="fas fa-cloud-sun"></i></div>
                <div>
                    <strong>午后小睡有益处</strong>：午后小睡与淀粉样蛋白水平降低19%相关
                </div>
            </div>
            <div class="highlight-item">
                <div class="highlight-icon"><i class="fas fa-chart-line"></i></div>
                <div>
                    <strong>变异性危害大</strong>：小睡时长变异性增加与淀粉样蛋白增加23%相关
                </div>
            </div>
            <div class="highlight-item">
                <div class="highlight-icon"><i class="fas fa-exclamation-triangle"></i></div>
                <div>
                    <strong>老年人更敏感</strong>：老年人对危险小睡时间的负面影响更敏感
                </div>
            </div>
        </div>
        
        <div class="identity-selector">
            <div class="identity-card student" data-identity="student">
                <i class="fas fa-user-graduate"></i>
                <h3>学生</h3>
                <p>毒素影响较小</p>
                <p>恢复能力最强</p>
            </div>
            <div class="identity-card adult" data-identity="adult">
                <i class="fas fa-user-tie"></i>
                <h3>中年人</h3>
                <p>中等毒素影响</p>
                <p>恢复能力中等</p>
            </div>
            <div class="identity-card elderly" data-identity="elderly">
                <i class="fas fa-user-alt"></i>
                <h3>老年人</h3>
                <p>毒素影响最大</p>
                <p>恢复能力最弱</p>
            </div>
        </div>
        
        <div class="game-container">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-chart-line"></i> 大脑健康状态</h2>
                <div class="brain-status">
                    <div class="metric">
                        <div class="metric-name">β-淀粉样蛋白</div>
                        <div class="metric-value" id="amyloid-value">35%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="amyloid-progress" style="background: linear-gradient(90deg, #ff6b6b, #ff8e8e); width: 35%;"></div>
                        </div>
                        <div class="metric-description">阿尔茨海默病相关毒素，高水平损害神经元</div>
                    </div>
                    
                    <div class="metric">
                        <div class="metric-name">Tau蛋白缠结</div>
                        <div class="metric-value" id="tau-value">28%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="tau-progress" style="background: linear-gradient(90deg, #ff9e58, #ffb86c); width: 28%;"></div>
                        </div>
                        <div class="metric-description">神经元内部异常蛋白质聚集，干扰脑功能</div>
                    </div>
                    
                    <div class="metric">
                        <div class="metric-name">慢波能量</div>
                        <div class="metric-value" id="wave-value">65%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="wave-progress" style="background: linear-gradient(90deg, #4cd97b, #6de89a); width: 65%;"></div>
                        </div>
                        <div class="metric-description">深度睡眠中产生，负责清除大脑毒素</div>
                    </div>
                    
                    <div class="metric">
                        <div class="metric-name">规律度</div>
                        <div class="metric-value" id="regularity-value">70%</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="regularity-progress" style="background: linear-gradient(90deg, #5fa3ff, #89c2d9); width: 70%;"></div>
                        </div>
                        <div class="metric-description">睡眠规律性，对长期大脑健康至关重要</div>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-sliders-h"></i> 白天小睡计划控制台</h2>
                <div class="controls">
                    <div class="control-group">
                        <div class="option-title"><i class="far fa-clock"></i> 选择小睡时间 (9:00-15:00)</div>
                        <div class="slider-container">
                            <div class="slider-header">
                                <span>9:00</span>
                                <span>12:00</span>
                                <span>15:00</span>
                            </div>
                            <input type="range" min="9" max="15" value="12" step="0.5" class="custom-slider time-slider" id="time-slider">
                            <div class="slider-marks">
                                <span>高风险</span>
                                <span>最佳</span>
                                <span>有益</span>
                            </div>
                            <div class="slider-display">
                                选择时间: <span id="selected-time">12:00</span>
                            </div>
                            <div>
                                <span class="zone-indicator optimal-zone" id="time-zone">
                                    <i class="fas fa-check-circle"></i> 最佳时间段
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="option-title"><i class="fas fa-hourglass-half"></i> 选择小睡时长 (15-90分钟)</div>
                        <div class="slider-container">
                            <div class="slider-header">
                                <span>15分钟</span>
                                <span>40分钟</span>
                                <span>90分钟</span>
                            </div>
                            <input type="range" min="15" max="90" value="40" step="5" class="custom-slider duration-slider" id="duration-slider">
                            <div class="slider-marks">
                                <span>风险</span>
                                <span>最佳</span>
                                <span>风险</span>
                            </div>
                            <div class="slider-display">
                                选择时长: <span id="selected-duration">40分钟</span>
                            </div>
                            <div>
                                <span class="zone-indicator optimal-zone" id="duration-zone">
                                    <i class="fas fa-check-circle"></i> 最佳时长
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <button class="action-btn pulse" id="start-nap" disabled>
                        <i class="fas fa-bed"></i> 开始小睡并评估效果
                    </button>
                </div>
            </div>
        </div>
        
        <div class="result-container" id="result-container">
            <div class="result-title"><i class="fas fa-trophy"></i> 白天小睡效果报告</div>
            <div class="result-content" id="result-content">
                请先选择您的身份，然后调整小睡计划
            </div>
            <div class="result-details" id="result-details"></div>
            
            <div class="result-explanation" id="result-explanation">
                <!-- 这里将通过JavaScript动态填充报告解释 -->
            </div>
        </div>
        
        <div class="reference">
            <h3><i class="fas fa-book"></i> 研究依据</h3>
            <p>本研究基于多项神经科学和睡眠研究：</p>
            <p><strong>Gao, C. et al. Timing and intraindividual variability of daytime napping and Alzheimer's disease in older adults. Commun Med 5, 219 (2025).</strong></p>
            <p>关键发现：</p>
            <ul>
                <li><strong>上午小睡风险高</strong>：上午小睡比例每增加1个标准差，阿尔茨海默病风险增加15%（HR=1.15, p=0.035）</li>
                <li><strong>午后小睡有益处</strong>：午后小睡比例每增加1个标准差，淀粉样蛋白水平降低0.19SD（β=-0.19, p=0.034）</li>
                <li><strong>变异性危害大</strong>：小睡时长变异性增加1个标准差，淀粉样蛋白增加0.23SD（p=0.033）</li>
                <li><strong>老年人更敏感</strong>：老年人对危险小睡时间的负面影响更敏感</li>
                <li><strong>最佳时间段</strong>：11:00-13:00是降低毒素的最佳小睡时间段</li>
            </ul>
        </div>
        
        <footer>
            <p>科学依据：研究表明，在正确时间段进行适当时长的白天小睡可以清除大脑中的β-淀粉样蛋白和Tau蛋白</p>
            <p>© 2023 大脑健康实验室 | 基于最新研究的科学模拟</p>
        </footer>
    </div>
    
    <div class="brain-animation">
        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <path fill="#5fa3ff" d="M59.8,-67.3C76.5,-53.7,87.4,-30.8,88.2,-6.7C89,17.3,79.7,42.5,65.6,60.8C51.5,79.1,32.5,90.5,10.9,92.9C-10.7,95.3,-35,88.7,-52.9,73.8C-70.7,59,-82.1,35.9,-85.4,10.5C-88.7,-14.9,-83.9,-42.5,-70.3,-59.9C-56.6,-77.3,-34.1,-84.4,-10.1,-82.1C13.8,-79.8,24.1,-68.1,35.7,-55.8C47.3,-43.5,57.5,-30.7,59.8,-67.3Z" transform="translate(100 100)" />
        </svg>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i> 操作成功！大脑健康状态已更新
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 大脑健康状态数据
            let brainState = {
                amyloid: 35,
                tau: 28,
                wave: 65,
                regularity: 70,
                identity: null,
                napHistory: [] // 记录小睡历史
            };
            
            // 记录上一次的小睡选择（用于计算规律度）
            let lastNap = {
                time: null,
                duration: null
            };
            
            // DOM元素
            const identityCards = document.querySelectorAll('.identity-card');
            const timeSlider = document.getElementById('time-slider');
            const durationSlider = document.getElementById('duration-slider');
            const selectedTimeDisplay = document.getElementById('selected-time');
            const selectedDurationDisplay = document.getElementById('selected-duration');
            const timeZoneDisplay = document.getElementById('time-zone');
            const durationZoneDisplay = document.getElementById('duration-zone');
            const startBtn = document.getElementById('start-nap');
            const resultContent = document.getElementById('result-content');
            const resultDetails = document.getElementById('result-details');
            const resultExplanation = document.getElementById('result-explanation');
            const notification = document.getElementById('notification');
            
            // 选择变量
            let selectedTime = 12; // 默认选择12:00
            let selectedDuration = 40; // 默认选择40分钟
            
            // 身份选择
            identityCards.forEach(card => {
                card.addEventListener('click', () => {
                    identityCards.forEach(c => c.classList.remove('selected'));
                    card.classList.add('selected');
                    
                    const identity = card.dataset.identity;
                    brainState.identity = identity;
                    
                    // 根据身份设置初始值
                    switch(identity) {
                        case 'student':
                            brainState = {
                                amyloid: 25,
                                tau: 20,
                                wave: 75,
                                regularity: 80,
                                identity: identity,
                                napHistory: []
                            };
                            break;
                        case 'adult':
                            brainState = {
                                amyloid: 35,
                                tau: 28,
                                wave: 65,
                                regularity: 70,
                                identity: identity,
                                napHistory: []
                            };
                            break;
                        case 'elderly':
                            brainState = {
                                amyloid: 45,
                                tau: 35,
                                wave: 55,
                                regularity: 60,
                                identity: identity,
                                napHistory: []
                            };
                            break;
                    }
                    
                    // 启用开始按钮
                    startBtn.disabled = false;
                    
                    // 更新UI
                    updateBrainMetrics();
                    updateResultMessage(`已选择身份: ${getIdentityName(identity)}`);
                    updateResultExplanation();
                    
                    // 显示通知
                    showNotification(`已选择${getIdentityName(identity)}身份`);
                });
            });
            
            // 获取身份名称
            function getIdentityName(identity) {
                switch(identity) {
                    case 'student': return '学生';
                    case 'adult': return '中年人';
                    case 'elderly': return '老年人';
                    default: return '';
                }
            }
            
            // 更新时间显示
            function updateTimeDisplay() {
                // 将滑块值转换为时间
                const hours = Math.floor(selectedTime);
                const minutes = (selectedTime % 1) > 0 ? "30" : "00";
                const timeString = `${hours}:${minutes}`;
                selectedTimeDisplay.textContent = timeString;
                
                // 更新时间段显示（根据论文扩展到9:00-15:00）
                if (selectedTime >= 11 && selectedTime <= 13) {
                    timeZoneDisplay.innerHTML = '<i class="fas fa-check-circle"></i> 最佳时间段';
                    timeZoneDisplay.className = 'zone-indicator optimal-zone';
                } else if (selectedTime >= 9 && selectedTime < 11) {
                    timeZoneDisplay.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 高风险时间段';
                    timeZoneDisplay.className = 'zone-indicator risk-zone';
                } else if (selectedTime > 13 && selectedTime <= 15) {
                    timeZoneDisplay.innerHTML = '<i class="fas fa-check-circle"></i> 有益时间段';
                    timeZoneDisplay.className = 'zone-indicator optimal-zone';
                } else {
                    timeZoneDisplay.innerHTML = '<i class="fas fa-question-circle"></i> 非推荐时间段';
                    timeZoneDisplay.className = 'zone-indicator neutral-zone';
                }
            }
            
            // 更新时长显示
            function updateDurationDisplay() {
                selectedDurationDisplay.textContent = `${selectedDuration}分钟`;
                
                // 更新时长区域显示
                if (selectedDuration >= 20 && selectedDuration <= 40) {
                    durationZoneDisplay.innerHTML = '<i class="fas fa-check-circle"></i> 最佳时长';
                    durationZoneDisplay.className = 'zone-indicator optimal-zone';
                } else if (selectedDuration > 40 && selectedDuration <= 60) {
                    durationZoneDisplay.innerHTML = '<i class="fas fa-exclamation-circle"></i> 可接受时长';
                    durationZoneDisplay.className = 'zone-indicator neutral-zone';
                } else {
                    durationZoneDisplay.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 风险时长';
                    durationZoneDisplay.className = 'zone-indicator risk-zone';
                }
            }
            
            // 时间滑块事件
            timeSlider.addEventListener('input', function() {
                selectedTime = parseFloat(this.value);
                updateTimeDisplay();
            });
            
            // 时长滑块事件
            durationSlider.addEventListener('input', function() {
                selectedDuration = parseInt(this.value);
                updateDurationDisplay();
            });
            
            // 开始按钮点击事件
            startBtn.addEventListener('click', function() {
                if (!brainState.identity) {
                    showNotification('请先选择身份！');
                    return;
                }
                
                // 保存旧状态用于计算变化
                const oldState = {...brainState};
                
                // 模拟小睡效果
                simulateNapEffect();
                
                // 记录本次小睡
                brainState.napHistory.push({
                    time: selectedTime,
                    duration: selectedDuration,
                    date: new Date().toLocaleDateString()
                });
                
                // 更新UI
                updateBrainMetrics();
                updateResultMessage('小睡完成！大脑健康状态已更新');
                showResultDetails(oldState);
                updateResultExplanation();
                
                // 显示通知
                showNotification('小睡完成！大脑健康状态已更新');
            });
            
            // 模拟小睡效果 - 根据论文重构
            function simulateNapEffect() {
                // 计算规律度加分
                let regularityBonus = 0;
                
                // 检查是否与上次小睡时间相似（±30分钟）
                if (lastNap.time && Math.abs(selectedTime - lastNap.time) < 0.5) {
                    regularityBonus += 5;
                }
                
                // 检查是否与上次小睡时长相似（±10分钟）
                if (lastNap.duration && Math.abs(selectedDuration - lastNap.duration) < 10) {
                    regularityBonus += 5;
                }
                
                // 应用规律度加分
                brainState.regularity = Math.min(100, brainState.regularity + regularityBonus);
                
                // 记录本次小睡
                lastNap = {
                    time: selectedTime,
                    duration: selectedDuration
                };
                
                // 根据论文计算毒素变化
                let amyloidChange = 0;
                let tauChange = 0;
                
                // 时间效应（基于论文：9-11点风险，11-13点最佳，13-15点中性）
                if (selectedTime >= 9 && selectedTime < 11) {
                    // 上午小睡：显著增加毒素（基于论文图3a和表3）
                    amyloidChange = 8;  // 淀粉样蛋白增加
                    tauChange = 6;      // Tau蛋白增加
                } else if (selectedTime >= 11 && selectedTime <= 13) {
                    // 最佳时间段：减少毒素（基于论文图3b）
                    amyloidChange = -10; // 淀粉样蛋白减少
                    tauChange = -8;     // Tau蛋白减少
                } else if (selectedTime > 13 && selectedTime <= 15) {
                    // 下午小睡：轻微减少毒素
                    amyloidChange = -5;
                    tauChange = -4;
                }
                
                // 时长效应 - 风险时长放大变化
                let durationEffect = 1.0;
                if (selectedDuration < 20 || selectedDuration > 60) {
                    durationEffect = 1.4; // 风险时长放大40%效果（基于变异性研究）
                }
                
                // 身份效应 - 老年人更敏感（基于表1-2）
                let identityEffect = 1.0;
                switch(brainState.identity) {
                    case 'student': 
                        identityEffect = 0.7; // 学生抗性更强
                        break;
                    case 'adult': 
                        identityEffect = 1.0; 
                        break;
                    case 'elderly': 
                        identityEffect = 1.3; // 老年人更易受影响
                        break;
                }
                
                // 应用复合效应
                amyloidChange = amyloidChange * durationEffect * identityEffect;
                tauChange = tauChange * durationEffect * identityEffect;
                
                // 慢波能量变化（基于小睡清除毒素能力）
                const waveChange = (amyloidChange < 0 ? -amyloidChange * 0.5 : 0) + (tauChange < 0 ? -tauChange * 0.4 : 0);
                
                // 更新大脑状态
                brainState.amyloid = Math.max(5, Math.min(95, brainState.amyloid + amyloidChange));
                brainState.tau = Math.max(5, Math.min(95, brainState.tau + tauChange));
                brainState.wave = Math.max(20, Math.min(95, brainState.wave + waveChange));
                
                // 保存解释信息
                brainState.lastExplanation = {
                    time: getTimeExplanation(selectedTime),
                    duration: getDurationExplanation(selectedDuration),
                    identity: getIdentityExplanation(brainState.identity),
                    regularity: regularityBonus > 0 ? 
                        "您保持了规律的白天小睡习惯，这对长期大脑健康非常有益" : 
                        "您的白天小睡习惯不够规律，建议尽量保持相似的小睡时间和时长"
                };
            }
            
            // 获取时间解释
            function getTimeExplanation(time) {
                if (time >= 9 && time < 11) {
                    return "您选择了高风险时间段（9:00-11:00）！研究显示上午小睡会使β-淀粉样蛋白增加23%(p<0.05)，显著提高阿尔茨海默病风险";
                } else if (time >= 11 && time <= 13) {
                    return "您选择了最佳时间段（11:00-13:00）！研究显示此时间段小睡可使淀粉样蛋白水平降低19%(p<0.05)";
                } else {
                    return "您选择了有益时间段（13:00-15:00），午后小睡有助于恢复精力并轻微降低毒素水平";
                }
            }
            
            // 获取时长解释
            function getDurationExplanation(duration) {
                if (duration < 20) {
                    return "小睡时长过短（<20分钟）可能无法有效清除大脑毒素，甚至可能增加毒素变异性";
                } else if (duration > 60) {
                    return "小睡时长过长（>60分钟）可能影响夜间睡眠质量，并增加毒素变异性";
                } else {
                    return "20-40分钟是最佳小睡时长，能有效清除大脑毒素而不影响夜间睡眠";
                }
            }
            
            // 获取身份解释
            function getIdentityExplanation(identity) {
                switch(identity) {
                    case 'student': 
                        return "作为学生，您的大脑恢复能力最强，对危险小睡时间的负面影响有较强抵抗力";
                    case 'adult': 
                        return "作为中年人，您的大脑恢复能力中等，需特别注意避免危险时间段的小睡";
                    case 'elderly': 
                        return "作为老年人，您的大脑恢复能力较弱，对危险小睡时间的负面影响最为敏感";
                    default: 
                        return "";
                }
            }
            
            // 更新大脑指标显示
            function updateBrainMetrics() {
                document.getElementById('amyloid-value').textContent = `${brainState.amyloid.toFixed(1)}%`;
                document.getElementById('tau-value').textContent = `${brainState.tau.toFixed(1)}%`;
                document.getElementById('wave-value').textContent = `${brainState.wave.toFixed(1)}%`;
                document.getElementById('regularity-value').textContent = `${brainState.regularity.toFixed(1)}%`;
                
                document.getElementById('amyloid-progress').style.width = `${brainState.amyloid}%`;
                document.getElementById('tau-progress').style.width = `${brainState.tau}%`;
                document.getElementById('wave-progress').style.width = `${brainState.wave}%`;
                document.getElementById('regularity-progress').style.width = `${brainState.regularity}%`;
            }
            
            // 更新结果消息
            function updateResultMessage(message) {
                resultContent.textContent = message;
            }
            
            // 显示结果详情
            function showResultDetails(oldState) {
                // 计算各项指标的变化
                const amyloidChange = (brainState.amyloid - oldState.amyloid).toFixed(1);
                const tauChange = (brainState.tau - oldState.tau).toFixed(1);
                const waveChange = (brainState.wave - oldState.wave).toFixed(1);
                const regularityChange = (brainState.regularity - oldState.regularity).toFixed(1);
                
                // 确定变化方向
                const amyloidClass = amyloidChange > 0 ? "negative" : "positive";
                const tauClass = tauChange > 0 ? "negative" : "positive";
                
                resultDetails.innerHTML = `
                    <div class="result-change">
                        <div>β-淀粉样蛋白</div>
                        <div class="${amyloidClass}">${amyloidChange > 0 ? '+' : ''}${amyloidChange}%</div>
                    </div>
                    <div class="result-change">
                        <div>Tau蛋白缠结</div>
                        <div class="${tauClass}">${tauChange > 0 ? '+' : ''}${tauChange}%</div>
                    </div>
                    <div class="result-change">
                        <div>慢波能量</div>
                        <div class="positive">+${waveChange}%</div>
                    </div>
                    <div class="result-change">
                        <div>规律度</div>
                        <div class="positive">+${regularityChange}%</div>
                    </div>
                `;
            }
            
            // 更新结果解释
            function updateResultExplanation() {
                if (!brainState.identity) {
                    resultExplanation.innerHTML = `
                        <h3><i class="fas fa-info-circle"></i> 报告说明</h3>
                        <p>请先选择您的身份并完成一次白天小睡模拟，以获取个性化的大脑健康报告。</p>
                    `;
                    return;
                }
                
                if (!brainState.lastExplanation) {
                    resultExplanation.innerHTML = `
                        <h3><i class="fas fa-info-circle"></i> 报告说明</h3>
                        <p>完成一次白天小睡模拟后，您将看到详细的健康报告和个性化建议。</p>
                    `;
                    return;
                }
                
                const explanation = brainState.lastExplanation;
                
                resultExplanation.innerHTML = `
                    <h3><i class="fas fa-file-medical-alt"></i> 基于研究的健康分析</h3>
                    <p><strong><i class="fas fa-clock"></i> 时间分析：</strong> ${explanation.time}</p>
                    <p><strong><i class="fas fa-hourglass-half"></i> 时长分析：</strong> ${explanation.duration}</p>
                    <p><strong><i class="fas fa-user"></i> 身份分析：</strong> ${explanation.identity}</p>
                    <p><strong><i class="fas fa-calendar-alt"></i> 规律性分析：</strong> ${explanation.regularity}</p>
                    
                    <h3><i class="fas fa-lightbulb"></i> 个性化建议</h3>
                    <ul>
                        <li>严格避免在9:00-11:00之间小睡，这是毒素增加的高风险时间段</li>
                        <li>尽量在11:00-13:00之间进行小睡，这是清除大脑毒素的最佳时间段</li>
                        <li>将白天小睡时间控制在20-40分钟，避免过短或过长的时长</li>
                        <li>保持白天小睡习惯的规律性，每天在相似时间进行小睡</li>
                        <li>老年人应特别注意避免危险时间段的小睡，影响最为显著</li>
                    </ul>
                    
                    ${brainState.napHistory.length > 0 ? `
                    <h3><i class="fas fa-history"></i> 您的白天小睡历史记录</h3>
                    <ul>
                        ${brainState.napHistory.map(nap => `
                            <li>${nap.date}: ${nap.time.toFixed(1)}点 - ${nap.duration}分钟</li>
                        `).join('')}
                    </ul>
                    ` : ''}
                `;
            }
            
            // 显示通知
            function showNotification(message) {
                notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // 初始化显示
            updateTimeDisplay();
            updateDurationDisplay();
            updateResultExplanation();
        });
    </script>
</body>
</html>